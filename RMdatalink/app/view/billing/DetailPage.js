/*
 * File: app/view/billing/DetailPage.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.3.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.3.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('RMdatalink.view.billing.DetailPage', {
    extend: 'Ext.Container',
    alias: 'widget.billingdetailpage',

    requires: [
        'RMdatalink.view.productDatalinkInvoice',
        'RMdatalink.view.billing.detailedListContainer',
        'RMdatalink.view.listWithHeader',
        'Ext.tab.Panel',
        'Ext.Label',
        'Ext.form.Panel',
        'Ext.form.FieldSet',
        'Ext.Img',
        'Ext.field.Search',
        'Ext.field.Select',
        'Ext.Button',
        'Ext.field.TextArea',
        'Ext.tab.Bar',
        'Ext.field.File',
        'Ext.field.Number',
        'Ext.field.Email',
        'Ext.field.Url'
    ],

    config: {
        height: '100%',
        width: '100%',
        layout: 'vbox',
        items: [
            {
                xtype: 'container',
                flex: 15,
                layout: 'hbox',
                items: [
                    {
                        xtype: 'tabpanel',
                        flex: 4,
                        cls: 'x-rm-tabpanel',
                        itemId: 'billingDetailsMainTabPanel',
                        ui: 'light',
                        items: [
                            {
                                xtype: 'container',
                                action: 'setScrollBarVisible',
                                title: 'SUBSCRIPTIONS',
                                itemId: 'billingSubscriptionsTab',
                                scrollable: true,
                                layout: {
                                    type: 'vbox',
                                    align: 'start'
                                },
                                listeners: [
                                    {
                                        fn: function(component, eOpts) {

                                        },
                                        event: 'initialize'
                                    }
                                ],
                                items: [
                                    {
                                        xtype: 'panel',
                                        width: '100%',
                                        layout: {
                                            type: 'hbox',
                                            align: 'start'
                                        },
                                        items: [
                                            {
                                                xtype: 'label',
                                                html: 'Product',
                                                margin: '0 0 0 5px'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'productdatalinkinvoice',
                                        height: 600,
                                        width: '99%'
                                    },
                                    {
                                        xtype: 'formpanel',
                                        action: 'setScrollBarVisible',
                                        cls: ' x-rm-rdformpanel',
                                        height: 600,
                                        id: 'productRmproInvoicePanel',
                                        itemId: 'productRmproInvoicePanel',
                                        width: '99%',
                                        scrollable: 'vertical',
                                        layout: {
                                            type: 'vbox',
                                            align: 'start'
                                        },
                                        items: [
                                            {
                                                xtype: 'fieldset',
                                                baseCls: 'none',
                                                border: '0 0 0 0',
                                                itemId: 'invoiceRMProHideShowFldSet',
                                                margin: '10 0 0 20',
                                                layout: 'hbox',
                                                items: [
                                                    {
                                                        xtype: 'image',
                                                        height: '30px;',
                                                        itemId: 'invoiceRMPROHideShowImg',
                                                        width: 35,
                                                        src: 'resources/images/labelHeader/downArrow.png',
                                                        listeners: [
                                                            {
                                                                fn: function(component, eOpts) {
                                                                    component.element.on('tap',function(){


                                                                        var rmProBillngPanel =  component.getParent().getParent().down('#invoiceRmproBillingFldsPanel');

                                                                        var childs = component.getParent().getParent().getItems().items ;
                                                                        for(var i=0;i< childs.length; i++){

                                                                            if(childs[i].config.xtype =="panel"){
                                                                                var child = childs[i] ;
                                                                                child.setHidden(! child.getHidden());
                                                                                if( child.getHidden()){

                                                                                    component.setSrc('resources/images/labelHeader/rightArrow.png');
                                                                                }else{
                                                                                    component.setSrc('resources/images/labelHeader/downArrow.png') ;
                                                                                }

                                                                            }
                                                                        }

                                                                        rmProBillngPanel.setHidden(! rmProBillngPanel.getHidden());

                                                                        if(rmProBillngPanel.getHidden())
                                                                        {
                                                                            Ext.ComponentQuery.query('#productRmproInvoicePanel')[0].setHeight(30);
                                                                        }else{

                                                                            Ext.ComponentQuery.query('#productRmproInvoicePanel')[0].setHeight(1150);
                                                                            // RMdatalink.app.getController('InvoiceController').setRMProPanelHeight() ;
                                                                            //Ext.ComponentQuery.query('#productRmproInvoicePanel')[0].setHeight(600);
                                                                        }


                                                                        //     var child = component.getParent().getParent().down('panel') ;
                                                                        //     child.setHidden(! child.getHidden());
                                                                        //     if( child.getHidden()){

                                                                        //        component.setSrc('resources/images/labelHeader/rightArrow.png');
                                                                        //     }else{
                                                                        //         component.setSrc('resources/images/labelHeader/downArrow.png') ;
                                                                        //     }

                                                                    });
                                                                },
                                                                event: 'initialize'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'label',
                                                        html: 'RM-PRO',
                                                        itemId: 'mylabel58',
                                                        style: 'font-size:12px;'
                                                    },
                                                    {
                                                        xtype: 'label',
                                                        itemId: 'billingRMProDtlsLbl',
                                                        margin: '0 0 0 20',
                                                        style: 'font-size:12px;'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'panel',
                                                hidden: false,
                                                itemId: 'invoiceRmProPackageListPanel',
                                                margin: '10 0 0 20',
                                                width: '100%',
                                                layout: 'vbox',
                                                items: [
                                                    {
                                                        xtype: 'fieldset',
                                                        baseCls: 'none',
                                                        border: '0 0 0 0',
                                                        margin: '10 0 0 20',
                                                        layout: 'hbox',
                                                        items: [
                                                            {
                                                                xtype: 'image',
                                                                height: '30px;',
                                                                itemId: 'myimg8',
                                                                width: 35,
                                                                src: 'resources/images/labelHeader/downArrow.png',
                                                                listeners: [
                                                                    {
                                                                        fn: function(component, eOpts) {
                                                                            component.element.on('tap',function(){

                                                                                var child = component.getParent().getParent().down('panel') ;
                                                                                child.setHidden(! child.getHidden());
                                                                                if( child.getHidden()){

                                                                                    component.setSrc('resources/images/labelHeader/rightArrow.png');
                                                                                }else{
                                                                                    component.setSrc('resources/images/labelHeader/downArrow.png') ;
                                                                                }

                                                                            });
                                                                        },
                                                                        event: 'initialize'
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                xtype: 'label',
                                                                html: 'Package Name',
                                                                itemId: 'invoiceRmProPackNameLbl',
                                                                style: 'font-size:12px;'
                                                            },
                                                            {
                                                                xtype: 'label',
                                                                docked: 'right',
                                                                html: 'Bundel Price',
                                                                itemId: 'invoiceRmProBundelPriceLbl',
                                                                margin: '0 12% 0 0',
                                                                style: 'font-size:12px;'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'billingdetailedlistcontainer',
                                                        height: '200px',
                                                        hidden: false,
                                                        itemId: 'invoiceRmProPackageListSubPanel',
                                                        margin: '10 0 0 50',
                                                        padding: '0 0 0 0'
                                                    }
                                                ],
                                                listeners: [
                                                    {
                                                        fn: function(component, eOpts) {

                                                            var headers = component.down("#billingDetListHeader");
                                                            headers.setData([{}]);
                                                            headers.setItemTpl(
                                                            Ext.create('Ext.XTemplate',
                                                            '<div class="x-rm-listtpl-main">',
                                                            '    <div style="width: 6%;">',
                                                            '        <div style="width: 20px;" data-name="all"></div>',
                                                            '    </div>',

                                                            '    <div style="width: 20%;" data-name="module_name">',
                                                            '        Product Name&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 12%;" data-name="quantity">',
                                                            '        Qty&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="module_standard_price">',
                                                            '        Unit Price&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="module_promotional_price">',
                                                            '        Promotional Price&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="per_month">',
                                                            '        Amount&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '</div>'
                                                            )
                                                            );
                                                            headers.refresh();
                                                            var list = component.down('#billingDetList');
                                                            list.setStore(Ext.getStore('products.BillingFromPackages'));
                                                            list.setItemTpl(
                                                            Ext.create('Ext.XTemplate',
                                                            '<div class="x-rm-listtpl-main pointerCursor">',
                                                            '    <div style="width: 6%;">',
                                                            '    </div>',
                                                            '    <div style="width: 20%;">{module_name}</div>',
                                                            '    <div style="width: 12%;">{quantity}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;">{module_standard_price}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;">{module_promotional_price}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;"></div>',
                                                            '</div>'
                                                            )
                                                            );

                                                            // list.setMode("SINGLE");
                                                            //     list.on("select",function(rmProlist, record, eOpts){
                                                            //         RMdatalink.app.getController('RMProController').onProductRMProListSelect(rmProlist, record, eOpts);
                                                            // });

                                                            list.setItemHeight(22);
                                                            list.setMode('MULTI');
                                                            list.addCls('x-rm-rdvendorslist');


                                                            //////////////////////////////////////////////////////////////////////////

                                                        },
                                                        event: 'initialize'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'panel',
                                                hidden: false,
                                                itemId: 'invoiceRmProAddOnsListPanel',
                                                margin: '10 0 0 20',
                                                width: '100%',
                                                layout: 'vbox',
                                                items: [
                                                    {
                                                        xtype: 'fieldset',
                                                        baseCls: 'none',
                                                        border: '0 0 0 0',
                                                        margin: '10 0 0 20',
                                                        layout: 'hbox',
                                                        items: [
                                                            {
                                                                xtype: 'image',
                                                                height: '30px;',
                                                                itemId: 'myimg8',
                                                                width: 35,
                                                                src: 'resources/images/labelHeader/downArrow.png',
                                                                listeners: [
                                                                    {
                                                                        fn: function(component, eOpts) {
                                                                            component.element.on('tap',function(){

                                                                                var child = component.getParent().getParent().down('panel') ;
                                                                                child.setHidden(! child.getHidden());
                                                                                if( child.getHidden()){

                                                                                    component.setSrc('resources/images/labelHeader/rightArrow.png');
                                                                                }else{
                                                                                    component.setSrc('resources/images/labelHeader/downArrow.png') ;
                                                                                }

                                                                            });
                                                                        },
                                                                        event: 'initialize'
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                xtype: 'label',
                                                                html: 'Add-ons',
                                                                itemId: 'mylabel58',
                                                                style: 'font-size:12px;'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'billingdetailedlistcontainer',
                                                        height: '200px',
                                                        hidden: false,
                                                        itemId: 'invoiceRmProAddOnsListSubPanel',
                                                        margin: '10 0 0 50',
                                                        padding: '0 0 0 0'
                                                    }
                                                ],
                                                listeners: [
                                                    {
                                                        fn: function(component, eOpts) {
                                                            var headers = component.down("#billingDetListHeader");
                                                            headers.setData([{}]);
                                                            headers.setItemTpl(
                                                            Ext.create('Ext.XTemplate',
                                                            '<div class="x-rm-listtpl-main">',
                                                            '    <div style="width: 6%;">',
                                                            '        <div style="width: 20px;" data-name="all"></div>',
                                                            '    </div>',

                                                            '    <div style="width: 20%;" data-name="module_name">',
                                                            '        Product Name&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 12%;" data-name="quantity">',
                                                            '        Qty&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="module_standard_price">',
                                                            '        Unit Price&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="module_promotional_price">',
                                                            '        Promotional Price&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '    <div style="width: 20%;" data-name="per_month">',
                                                            '        Amount&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                            '    </div>',
                                                            '</div>'
                                                            )
                                                            );
                                                            headers.refresh();
                                                            var list = component.down('#billingDetList');
                                                            list.setStore(Ext.getStore('products.BillingModuleAddons'));
                                                            list.setItemTpl(
                                                            Ext.create('Ext.XTemplate',
                                                            '<div class="x-rm-listtpl-main pointerCursor">',
                                                            '    <div style="width: 6%;">',

                                                            '    </div>',

                                                            '    <div style="width: 20%;">{module_name}</div>',
                                                            '    <div style="width: 12%;">{quantity}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;">{module_standard_price}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;">{module_promotional_price}</div>',
                                                            '    <div style="width: 20%;padding-right: 1%;">{per_month}</div>',
                                                            '</div>'
                                                            )
                                                            );

                                                            ///////////////////
                                                            // list.setMode("SINGLE");
                                                            //     list.on("select",function(rmProlist, record, eOpts){
                                                            //         RMdatalink.app.getController('RMProController').onProductRMProListSelect(rmProlist, record, eOpts);
                                                            // });

                                                            list.setItemHeight(22);
                                                            list.setMode('MULTI');
                                                            list.addCls('x-rm-rdvendorslist');




                                                            /////////////////////////////////////////////////////////////////////////////
                                                        },
                                                        event: 'initialize'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'fieldset',
                                                itemId: 'invoiceRmproBillingFldsPanel',
                                                width: '100%',
                                                items: [
                                                    {
                                                        xtype: 'fieldset',
                                                        margin: '0 0 0 70',
                                                        layout: {
                                                            type: 'vbox',
                                                            align: 'end',
                                                            pack: 'end'
                                                        },
                                                        items: [
                                                            {
                                                                xtype: 'textfield',
                                                                disabled: true,
                                                                itemId: 'invoiceRmproSubtotal',
                                                                width: '200px',
                                                                inputCls: 'boldInputFld',
                                                                label: 'Sub Total',
                                                                labelWidth: '100px'
                                                            },
                                                            {
                                                                xtype: 'textfield',
                                                                disabled: true,
                                                                hidden: true,
                                                                itemId: 'invoiceRmproSaving',
                                                                width: '200px',
                                                                label: 'Saving',
                                                                labelWidth: '100px'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'fieldset',
                                                        padding: '0 0 0 0',
                                                        layout: 'hbox',
                                                        items: [
                                                            {
                                                                xtype: 'fieldset',
                                                                flex: 2,
                                                                layout: 'hbox',
                                                                items: [
                                                                    {
                                                                        xtype: 'fieldset',
                                                                        margin: '0 10px 0 0',
                                                                        padding: '0 0 0 0',
                                                                        width: '250px',
                                                                        title: '<div style="font-size:12px;">Commission</div>',
                                                                        items: [
                                                                            {
                                                                                xtype: 'textfield',
                                                                                action: 'invoiceRMproCommission',
                                                                                html: '<div style= "margin:-20% 0 0% 100% ;">$</div>',
                                                                                itemId: 'invoiceCommissionableAmtFld',
                                                                                width: '230px',
                                                                                label: 'Commissionable Amount',
                                                                                labelWidth: '150px'
                                                                            },
                                                                            {
                                                                                xtype: 'textfield',
                                                                                action: 'invoiceRMproCommission',
                                                                                html: '<div style= "margin:-20% 0 0% 100% ;">%</div>',
                                                                                itemId: 'invoiceCommissionPercentFld',
                                                                                width: '230px',
                                                                                label: 'Commission percent',
                                                                                labelWidth: '150px'
                                                                            }
                                                                        ]
                                                                    },
                                                                    {
                                                                        xtype: 'fieldset',
                                                                        flex: 2,
                                                                        itemId: 'rmProInvoiceSalesPersonsPanel',
                                                                        layout: 'vbox',
                                                                        title: '<div style="font-size:12px;">Sales person(s)</div>',
                                                                        items: [
                                                                            {
                                                                                xtype: 'searchfield',
                                                                                action: 'fillSearchDropDown',
                                                                                cls: 'x-field-techLogsearch',
                                                                                itemId: 'rtSalesPersonSearchFld',
                                                                                label: 'Salesperon(s)',
                                                                                labelWidth: '100px'
                                                                            },
                                                                            {
                                                                                xtype: 'listwithheader',
                                                                                height: '150px'
                                                                            }
                                                                        ],
                                                                        listeners: [
                                                                            {
                                                                                fn: function(component, eOpts) {
                                                                                    var headers = component.down("#headerList");
                                                                                    headers.setMargin(0);
                                                                                    headers.setHeight(0);
                                                                                    /*headers.setData([{}]);
                                                                                    headers.setItemTpl(
                                                                                    Ext.create('Ext.XTemplate',
                                                                                    '<div class="x-rm-listtpl-main" style="background-color: #DCDCDE ;">',

                                                                                    '    <div style="width: 40%;" data-name="discount_name">',
                                                                                    '        Advance Payment Benifits&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                                    '    </div>',
                                                                                    '    <div style="width: 15%;" data-name="discount_value">',
                                                                                    '        Discount&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                                    '    </div>',
                                                                                    '    <div style="width: 15%;" data-name="discount_saving">',
                                                                                    '        Saving&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                                    '    </div>',
                                                                                    '    <div style="width: 15%;" data-name="discount_total">',
                                                                                    '        Total&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                                    '    </div>',
                                                                                    '    <div style="width: 15%;" data-name="discount_per_month">',
                                                                                    '        Per Month&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                                    '    </div>',

                                                                                    '</div>'
                                                                                    )
                                                                                    );
                                                                                    headers.refresh();*/
                                                                                    var list = component.down('#mainList');
                                                                                    list.setMargin(0);
                                                                                    list.setStore(Ext.getStore('products.RtSalesPersonStore'));
                                                                                    list.setItemTpl(
                                                                                    Ext.create('Ext.XTemplate',
                                                                                    '<div class="x-rm-listtpl-main pointerCursor" style="margin-top: 12px;">',
                                                                                    '    <div style="width: 10%;"></div>',
                                                                                    '    <div style="width: 60%;padding: 0px 0px 0px 10px; padding-left: 7px;">{salesperson_name}</div>',
                                                                                    '    <input type="text" style="width: 20% !important;text-align:right;" class="x-rm-rdinlinecmt" data-id="{_id}" value="{salesperson_commission}" maxlength="24"',
                                                                                    '        onchange="RMdatalink.app.getController(\'InvoiceController\').updateSalesPersonsList(this,\'salesperson_commission\');"/><div style="margin-top: 2px;">%</div>',
                                                                                    '</div>'
                                                                                    )
                                                                                    );
                                                                                    list.setItemHeight(22);
                                                                                    list.setMode("SINGLE");
                                                                                    list.addCls('x-rm-rdvendorslist');
                                                                                    list.addCls('delMark-list') ;

                                                                                    list.setDisableSelection(true);
                                                                                    list.setOnItemDisclosure(true);
                                                                                    list.refresh();

                                                                                    list.on("disclose",function(salesPersonList, record, eOpts){
                                                                                        salesPersonList.getStore().remove(record) ;
                                                                                    });

                                                                                    //disclose( this, record, target, index, e, eOpts )
                                                                                },
                                                                                event: 'initialize'
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                xtype: 'fieldset',
                                                                docked: 'right',
                                                                width: '300px',
                                                                items: [
                                                                    {
                                                                        xtype: 'fieldset',
                                                                        width: '300px',
                                                                        layout: {
                                                                            type: 'vbox',
                                                                            align: 'end'
                                                                        },
                                                                        items: [
                                                                            {
                                                                                xtype: 'selectfield',
                                                                                itemId: 'invoiceRmProPaymentPrdSlFld',
                                                                                width: '250px',
                                                                                label: 'Payment Period',
                                                                                labelWidth: '150px',
                                                                                options: [
                                                                                    {
                                                                                        text: '1 Month',
                                                                                        value: 1
                                                                                    },
                                                                                    {
                                                                                        text: '3 Month',
                                                                                        value: 3
                                                                                    },
                                                                                    {
                                                                                        text: '6 Month',
                                                                                        value: 6
                                                                                    },
                                                                                    {
                                                                                        text: '9 Month',
                                                                                        value: 9
                                                                                    },
                                                                                    {
                                                                                        text: '1 Year',
                                                                                        value: 12
                                                                                    },
                                                                                    {
                                                                                        text: '2 Year',
                                                                                        value: 24
                                                                                    },
                                                                                    {
                                                                                        text: '3 Year',
                                                                                        value: 36
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                xtype: 'textfield',
                                                                                disabled: true,
                                                                                html: '<div style= "margin:-20% 0 0% 100% ;">%</div>',
                                                                                itemId: 'invoiceDiscountAppliedFld',
                                                                                width: '250px',
                                                                                label: 'Discount Applied',
                                                                                labelWidth: '150px'
                                                                            },
                                                                            {
                                                                                xtype: 'textfield',
                                                                                disabled: true,
                                                                                itemId: 'invoiceTotalSavingFld',
                                                                                width: '250px',
                                                                                label: 'Total Saving',
                                                                                labelWidth: '150px'
                                                                            }
                                                                        ]
                                                                    },
                                                                    {
                                                                        xtype: 'fieldset',
                                                                        width: '300px',
                                                                        layout: {
                                                                            type: 'vbox',
                                                                            align: 'end'
                                                                        },
                                                                        items: [
                                                                            {
                                                                                xtype: 'textfield',
                                                                                eventAction: 'RMPROsubscriptionEdited',
                                                                                itemId: 'invoiceTotalPaybleFld',
                                                                                width: '250px',
                                                                                inputCls: 'boldInputFld',
                                                                                label: '<b>Total Payble</b>',
                                                                                labelWidth: '150px'
                                                                            },
                                                                            {
                                                                                xtype: 'textfield',
                                                                                action: 'calRmproBalDue',
                                                                                itemId: 'invoicePastDueFld',
                                                                                width: '250px',
                                                                                label: 'Past Due',
                                                                                labelWidth: '150px'
                                                                            },
                                                                            {
                                                                                xtype: 'textfield',
                                                                                disabled: true,
                                                                                itemId: 'invoiceBalanceDueFld',
                                                                                width: '250px',
                                                                                label: 'Balance Due',
                                                                                labelWidth: '150px'
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'fieldset',
                                                        itemId: 'rmProextradtl',
                                                        layout: 'hbox',
                                                        items: [
                                                            {
                                                                xtype: 'textfield',
                                                                action: 'inputByDatePicker',
                                                                itemId: 'rmProSubscrPaymentStartDateFld',
                                                                width: '250px',
                                                                label: 'From Date'
                                                            },
                                                            {
                                                                xtype: 'textfield',
                                                                action: 'inputByDatePicker',
                                                                itemId: 'rmProSubscrPaymentEndDateFld',
                                                                width: '250px',
                                                                label: 'To Date'
                                                            },
                                                            {
                                                                xtype: 'textfield',
                                                                action: 'inputByDatePicker',
                                                                eventAction: 'RMPROsubscriptionEdited',
                                                                itemId: 'rmProSubscrPaymentDueDateFld',
                                                                width: '250px',
                                                                label: 'Due Date'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'fieldset',
                                                        itemId: 'myfieldset49',
                                                        layout: 'vbox',
                                                        items: [
                                                            {
                                                                xtype: 'label',
                                                                html: 'Previous Payments',
                                                                style: 'font-size:0.8em;'
                                                            },
                                                            {
                                                                xtype: 'listwithheader',
                                                                height: '90px',
                                                                width: '100%'
                                                            }
                                                        ],
                                                        listeners: [
                                                            {
                                                                fn: function(component, eOpts) {
                                                                    /*

                                                                    proccessed_by: ""
                                                                    pay_date: "06/17/2014"
                                                                    payment_method_detail: ""
                                                                    paid_by: "cash"

                                                                    ammount_paying: "400"
                                                                    cc_approval: ""
                                                                    date: "06/17/2014"

                                                                    */

                                                                    var headers = component.down("#headerList");
                                                                    headers.setData([{}]);
                                                                    headers.setItemTpl(
                                                                    Ext.create('Ext.XTemplate',
                                                                    '<div class="x-rm-listtpl-main">',
                                                                    '    <div style="width: 15%;" data-name="proccessed_by">',
                                                                    '        Proccessed by&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',
                                                                    '    <div style="width: 15%;" data-name="pay_date">',
                                                                    '        Pay Date&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',
                                                                    '    <div style="width: 15%;" data-name="paid_by">',
                                                                    '        Paid by&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',
                                                                    '    <div style="width: 15%;" data-name="cc_approval">',
                                                                    '        CC Approval&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',
                                                                    '    <div style="width: 15%;" data-name="payment_method_detail">',
                                                                    '        Check # / CC #&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',
                                                                    '    <div style="width: 15%;" data-name="ammount_paying">',
                                                                    '        Amount&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                                    '    </div>',

                                                                    '</div>'
                                                                    )
                                                                    );
                                                                    headers.refresh();
                                                                    var list = component.down('#mainList');
                                                                    list.setStore(Ext.getStore('InvoicePaymentsStore'));
                                                                    list.setItemTpl(
                                                                    Ext.create('Ext.XTemplate',
                                                                    '<div class="x-rm-listtpl-main pointerCursor">',
                                                                    '<div style="width: 15%;">{proccessed_by}</div>',
                                                                    '<div style="width: 15%;">{pay_date}</div>',
                                                                    '<div style="width: 15%;">{paid_by}</div>',
                                                                    '<div style="width: 15%;">{cc_approval}</div>',
                                                                    '<div style="width: 15%;">{payment_method_detail}</div>',
                                                                    '<div style="width: 15%;">{ammount_paying}</div>',
                                                                    '</div>'
                                                                    )
                                                                    );

                                                                    ///////////////////
                                                                    // list.setMode("SINGLE");
                                                                    //     list.on("select",function(rmProlist, record, eOpts){
                                                                    //         RMdatalink.app.getController('RMProController').onProductRMProListSelect(rmProlist, record, eOpts);
                                                                    // });

                                                                    list.setItemHeight(22);
                                                                    list.setMode('MULTI');
                                                                    list.addCls('x-rm-rdvendorslist');




                                                                },
                                                                event: 'initialize'
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        xtype: 'fieldset',
                                                        layout: 'hbox',
                                                        items: [
                                                            {
                                                                xtype: 'fieldset',
                                                                layout: 'vbox',
                                                                title: '<div style="font-size:12px;">Payments</div>',
                                                                items: [
                                                                    {
                                                                        xtype: 'textfield',
                                                                        action: 'inputByDatePicker',
                                                                        itemId: 'invoicePayDateFld',
                                                                        label: 'Pay Date',
                                                                        labelWidth: '100px'
                                                                    },
                                                                    {
                                                                        xtype: 'selectfield',
                                                                        itemId: 'invoicePaidByFld',
                                                                        label: 'Paid By',
                                                                        labelWidth: '100px',
                                                                        options: [
                                                                            {
                                                                                text: 'by Cash',
                                                                                value: 'cash'
                                                                            },
                                                                            {
                                                                                text: 'by Check',
                                                                                value: 'check'
                                                                            },
                                                                            {
                                                                                text: 'by Am Express',
                                                                                value: 'am_express'
                                                                            }
                                                                        ]
                                                                    },
                                                                    {
                                                                        xtype: 'textfield',
                                                                        itemId: 'invoicePaymentDetailFld',
                                                                        label: 'Check # / CC #',
                                                                        labelWidth: '100px'
                                                                    },
                                                                    {
                                                                        xtype: 'textfield',
                                                                        itemId: 'invoiceCCApprovalFld',
                                                                        label: 'CCApproval',
                                                                        labelWidth: '100px'
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                xtype: 'fieldset',
                                                                margin: '35px 5px 0 10px',
                                                                layout: 'vbox',
                                                                items: [
                                                                    {
                                                                        xtype: 'textfield',
                                                                        action: 'calRmproBalDue',
                                                                        itemId: 'invoiceAmmountFld',
                                                                        label: 'Ammount',
                                                                        labelWidth: '100px'
                                                                    },
                                                                    {
                                                                        xtype: 'textfield',
                                                                        itemId: 'invoiceCommissionFld',
                                                                        label: 'Commission',
                                                                        labelWidth: '100px'
                                                                    },
                                                                    {
                                                                        xtype: 'textfield',
                                                                        itemId: 'invoiceProcessedByFld',
                                                                        label: 'Proccessed By',
                                                                        labelWidth: '100px'
                                                                    },
                                                                    {
                                                                        xtype: 'textfield',
                                                                        action: 'inputByDatePicker',
                                                                        itemId: 'invoiceRMProDateFld',
                                                                        label: 'Date',
                                                                        labelWidth: '100px'
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                xtype: 'fieldset',
                                                                height: '145px',
                                                                margin: '40px 0 0 0',
                                                                width: '160px',
                                                                layout: {
                                                                    type: 'vbox',
                                                                    align: 'end',
                                                                    pack: 'end'
                                                                },
                                                                items: [
                                                                    {
                                                                        xtype: 'button',
                                                                        handler: function(button, e) {
                                                                            var that = this ;

                                                                            if(RMdatalink.app.getController('InvoiceHistoryController').config.displayGeneratedInvoice ){
                                                                                if(Ext.ComponentQuery.query('#InvoicePage')[0]){

                                                                                    Ext.ComponentQuery.query('#InvoicePage')[0].destroy() ;
                                                                                }






                                                                                var printTimeout = setTimeout(function(){


                                                                                    Ext.widget('InvoicePage').show();
                                                                                    RMdatalink.app.getController('InvoiceController').setRMproInvoiceToPrint();

                                                                                    clearTimeout(printTimeout);


                                                                                },100);
                                                                                return ;
                                                                            }




                                                                            var rmProInvoicePanel = Ext.ComponentQuery.query('#productRmproInvoicePanel')[0] ;

                                                                            if(! rmProInvoicePanel.down('#invoiceAmmountFld').getValue() || rmProInvoicePanel.down('#invoiceAmmountFld').getValue() <= 0){

                                                                                Ext.Msg.alert("Alert","Please Enter Ammount.");
                                                                                return ;
                                                                            }

                                                                            if(! rmProInvoicePanel.down('#invoiceBalanceDueFld').getValue() || rmProInvoicePanel.down('#invoiceBalanceDueFld').getValue() <= 0 ){


                                                                                RMdatalink.app.getController('InvoiceController').config.isSalesCommissionForRmPro = true ;
                                                                                RMdatalink.app.getController('InvoiceController').saveRmProInvoice(true,"product_rmpro");


                                                                            }

                                                                            else{


                                                                                if(Ext.ComponentQuery.query('#InvoicePage')[0]){

                                                                                    Ext.ComponentQuery.query('#InvoicePage')[0].destroy() ;
                                                                                }



                                                                                RMdatalink.app.getController('InvoiceController').addRmProPartialPayment() ;


                                                                                var printTimeout = setTimeout(function(){


                                                                                    Ext.widget('InvoicePage').show();
                                                                                    RMdatalink.app.getController('InvoiceController').setRMproInvoiceToPrint();
                                                                                    RMdatalink.app.getController('InvoiceController').hideShowPrintPaymentInfo(true);
                                                                                    clearTimeout(printTimeout);


                                                                                },100);
                                                                            }
                                                                        },
                                                                        cls: 'x-rm-blueBtn',
                                                                        docked: 'bottom',
                                                                        height: '25px',
                                                                        itemId: 'invoiceRmProPrintBtn',
                                                                        margin: '0 20 0 0',
                                                                        width: '150px',
                                                                        text: 'Print Invoice'
                                                                    },
                                                                    {
                                                                        xtype: 'button',
                                                                        cls: 'x-rm-blueBtn',
                                                                        docked: 'bottom',
                                                                        height: '25px',
                                                                        itemId: 'invoiceRMPROProductSetupBtn',
                                                                        margin: '10 20 10 0',
                                                                        width: '150px',
                                                                        text: 'Product Setup'
                                                                    },
                                                                    {
                                                                        xtype: 'label',
                                                                        html: 'Note:',
                                                                        style: 'font-size:80%;',
                                                                        width: '100%'
                                                                    },
                                                                    {
                                                                        xtype: 'textareafield',
                                                                        height: '60px',
                                                                        itemId: 'rmProPaymentNoteFld',
                                                                        margin: '0 0 5 0',
                                                                        width: '100%',
                                                                        labelWidth: '0%'
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        tabBar: {
                            docked: 'top',
                            width: '90%'
                        }
                    },
                    {
                        xtype: 'container',
                        flex: 2,
                        itemId: 'billingDetailsSideContainer',
                        margin: '8 0 0 8',
                        layout: 'fit',
                        items: [
                            {
                                xtype: 'formpanel',
                                cls: 'x-rm-rdformpanel',
                                height: '100%',
                                itemId: 'billingDtHistoryListPanel',
                                scrollable: false,
                                layout: {
                                    type: 'vbox',
                                    align: 'start',
                                    pack: 'center'
                                },
                                items: [
                                    {
                                        xtype: 'fieldset',
                                        cls: [
                                            'x-rm-rdformpanel',
                                            'noBorderFldSet'
                                        ],
                                        margin: '10 0 5 0',
                                        width: '98%',
                                        layout: 'hbox',
                                        items: [
                                            {
                                                xtype: 'searchfield',
                                                flex: 1,
                                                cls: 'x-field-techLogsearch',
                                                itemId: 'biilingInvoiceSearchForRtTxtFld'
                                            },
                                            {
                                                xtype: 'button',
                                                cls: 'x-rm-blueBtn',
                                                height: '25px',
                                                itemId: 'biilingInvoiceSearchForRtBtn',
                                                margin: '0 5 0 5',
                                                width: '60px',
                                                text: 'Search'
                                            },
                                            {
                                                xtype: 'button',
                                                cls: [
                                                    'x-rm-detailsSaveBtn',
                                                    'x-rm-detailsInnerBtns'
                                                ],
                                                height: '25px',
                                                itemId: 'biilingInvoiceDeleteBtn',
                                                margin: '0 5 0 5',
                                                minHeight: '25px',
                                                width: '60px',
                                                text: 'Delete'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'listwithheader',
                                        width: '100%',
                                        flex: 1
                                    },
                                    {
                                        xtype: 'button',
                                        cls: 'x-rm-blueBtn',
                                        docked: 'top',
                                        height: '25px',
                                        itemId: 'billingDtlsViewCurrentSubBtn',
                                        width: '100%',
                                        iconCls: 'arrow_left',
                                        text: 'View Current Subscriptions'
                                    }
                                ],
                                listeners: [
                                    {
                                        fn: function(component, eOpts) {

                                            var headers = component.down("#headerList");
                                            headers.setData([{}]);
                                            headers.setItemTpl(
                                            Ext.create('Ext.XTemplate',
                                            '<div class="x-rm-listtpl-main">',
                                            '    <div style="width: 6%;">',
                                            '        <div style="width: 20px;" data-name="all"></div>',
                                            '    </div>',
                                            '    <div style="width: 25%;" data-name="invoice_number">',
                                            '        Invoice No&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                            '    </div>',
                                            '    <div style="width: 25%;" data-name="invoice_product">',
                                            '        Product&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                            '    </div>',
                                            '    <div style="width: 20%;" data-name="due_date">',
                                            '        Due Date&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                            '    </div>',
                                            '    <div style="width: 25%;" data-name="total_payble">',
                                            '        Amount&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                            '    </div>',
                                            '</div>'
                                            )
                                            );
                                            headers.refresh();
                                            var list = component.down('#mainList');
                                            list.setStore(Ext.getStore('InvoiceHistoryStore'));
                                            list.setItemTpl(
                                            Ext.create('Ext.XTemplate',
                                            '<div class="x-rm-listtpl-main pointerCursor">',
                                            '    <div style="width: 6%;">',
                                            '    </div>',
                                            '    <div style="width: 25%;">{invoice_number}</div>',
                                            '    <div style="width: 25%;">{[this.getProductType(values)]}</div>',
                                            '    <div style="width: 20%;padding-right: 1%;">{due_date}</div>',
                                            '    <div style="width: 25%;padding-right: 1%;">{total_payble} $</div>',
                                            '</div>',
                                            {
                                                getProductType:function(record){

                                                    if(record.invoice_product == "product_datalink"){

                                                        return "Datalink" ;
                                                    }else if(record.invoice_product == "product_rmpro"){
                                                        return "RM-PRO" ;
                                                    }

                                                    return "";

                                                }

                                            }
                                            )
                                            );

                                            list.setMode("SINGLE");

                                            list.setAllowDeselect(false);

                                            list.on("select",function(invoiceList, record, eOpts){
                                                RMdatalink.app.getController('InvoiceHistoryController').onHistoryInvoiceSelect(invoiceList, record, eOpts);
                                            });

                                            list.setItemHeight(22);

                                            //list.addCls('x-rm-rdvendorslist');

                                        },
                                        event: 'initialize'
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ],
        listeners: [
            {
                fn: 'onContainerInitialize',
                event: 'initialize'
            },
            {
                fn: 'onContainerPainted',
                event: 'painted'
            }
        ]
    },

    onContainerInitialize: function(component, eOpts) {
        // component.down('#detailsSaveBtn').setHidden(false);



        // component.down('#detailsSaveBtn').element.on("tap",function(){

        //                 if(RMdatalink.app.getController('InvoiceHistoryController').config.displayGeneratedInvoice )
        //                 {
        //                       RMdatalink.app.getController('InvoiceHistoryController').updateInvoice() ;
        //                 }
        //                 else{

        //                     RMdatalink.app.getController('InvoiceController').saveRmProInvoice();
        //                 }


        // });

    },

    onContainerPainted: function(element, eOpts) {
         window.location.hash = 'billingDetailCard';

         RMdatalink.app.getController('InvoiceController').hiedeAllProductsPanel() ;
    }

});