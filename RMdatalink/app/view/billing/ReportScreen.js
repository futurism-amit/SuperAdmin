/*
 * File: app/view/billing/ReportScreen.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.3.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.3.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('RMdatalink.view.billing.ReportScreen', {
    extend: 'Ext.Container',
    alias: 'widget.billingreportscreen1',

    requires: [
        'RMdatalink.view.listWithHeader',
        'Ext.tab.Panel',
        'Ext.form.Panel',
        'Ext.form.FieldSet',
        'Ext.field.Select',
        'Ext.Button',
        'Ext.dataview.List',
        'Ext.XTemplate'
    ],

    config: {
        itemId: 'billingReportScreen',
        layout: 'fit',
        items: [
            {
                xtype: 'tabpanel',
                cls: 'x-rm-tabpanel',
                ui: 'light',
                items: [
                    {
                        xtype: 'container',
                        title: 'Monthly',
                        height: '100%',
                        layout: 'fit',
                        items: [
                            {
                                xtype: 'formpanel',
                                cls: ' x-rm-rdformpanel',
                                height: '100%',
                                itemId: 'billingMonthlyReportForm',
                                width: '100%',
                                layout: 'vbox',
                                scrollable: false,
                                items: [
                                    {
                                        xtype: 'fieldset',
                                        height: '80px',
                                        margin: '10 0 0 0',
                                        padding: '5 5 5 5',
                                        width: '40%',
                                        items: [
                                            {
                                                xtype: 'selectfield',
                                                itemId: 'billingReportSelectProductFld',
                                                label: 'Select Product',
                                                options: [
                                                    {
                                                        text: 'Datalink',
                                                        value: 'product_datalink'
                                                    },
                                                    {
                                                        text: 'RM PRO',
                                                        value: 'product_rmpro'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'fieldset',
                                                hidden: true,
                                                padding: '2 2 2 2',
                                                layout: 'hbox',
                                                title: '  <div style="font-size:12px;">Duration</div>',
                                                items: [
                                                    {
                                                        xtype: 'textfield',
                                                        action: 'inputByDatePicker',
                                                        flex: 1,
                                                        itemId: 'billingReportFromDateFld',
                                                        label: 'From'
                                                    },
                                                    {
                                                        xtype: 'textfield',
                                                        action: 'inputByDatePicker',
                                                        flex: 1,
                                                        itemId: 'billingReportToDateFld',
                                                        label: 'To'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'button',
                                                cls: 'x-rm-blueBtn',
                                                itemId: 'billingGenerateReportBtn',
                                                margin: '0 0 0 70%',
                                                width: '160px',
                                                text: 'Generate Report'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'fieldset',
                                        flex: 1,
                                        itemId: 'billingReportListFldSet',
                                        width: '100%',
                                        layout: 'vbox',
                                        items: [
                                            {
                                                xtype: 'listwithheader',
                                                flex: 1
                                            }
                                        ],
                                        listeners: [
                                            {
                                                fn: function(component, eOpts) {

                                                    var headers = component.down("#headerList");

                                                    headers.setStore(Ext.getStore('billing.ListHeaderStore'));
                                                    headers.setData([{}]);
                                                    headers.setItemTpl(
                                                    Ext.create('Ext.XTemplate',
                                                    '<div class="x-rm-listtpl-main">',
                                                    '    <div style="width: 8%;" data-name="store_account">',
                                                    '        Account #&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 20%;" data-name="store_name">',
                                                    '        Store&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 10%;" data-name="month0">',
                                                    '        {month0}&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',

                                                    '</div>'
                                                    )
                                                    );
                                                    headers.refresh();
                                                    var list = component.down('#mainList');
                                                    list.setStore(Ext.getStore('billing.MonthlyReportStore'));
                                                    list.setItemTpl(
                                                    Ext.create('Ext.XTemplate',
                                                    '<div class="x-rm-listtpl-main">',
                                                    '    <div style="width: 8%;"> {store_account}</div>',
                                                    '    <div style="width: 20%;">{store_name}</div>',
                                                    '    <div style="width: 10%;">{month0}</div>',
                                                    '</div>'
                                                    )
                                                    );

                                                    // list.setMode("SINGLE");
                                                    //     list.on("select",function(rmProlist, record, eOpts){
                                                    //         RMdatalink.app.getController('RMProController').onProductRMProListSelect(rmProlist, record, eOpts);
                                                    // });

                                                    list.setItemHeight(22);

                                                    list.addCls('x-rm-rdvendorslist');

                                                    //list.onStoreClear();
                                                    //list.refresh();



                                                    // var totalsList = component.down('#inhouseTotalsList');
                                                    // var store = list.getStore();
                                                    // totalsList.setData([{}]);
                                                    // totalsList.setItemTpl(
                                                    //     Ext.create('Ext.XTemplate',
                                                    //                '<div class="x-rm-listtpl-main">',
                                                    //                '    <div style="width: 6%;">TOTALS</div>',
                                                    //                '    <div style="width: 12%;">{[this.getTotalFor(\'store_name\')]}&nbsp; Retailers</div>',
                                                    //                '    <div style="width: 10%;">{[this.getTotalFor(\'Users\')]}&nbsp; Users</div>',
                                                    //                '    <div style="width: 43%;">{[this.getTotalFor(\'store_city\')]}&nbsp; Cities</div>',
                                                    //                '    <div style="width: 5%;">{[this.getTotalFor(\'store_products_datalink\')]}</div>',
                                                    //                '    <div style="width: 5%;">{[this.getTotalFor(\'store_products_ecatalog\')]}</div>',
                                                    //                '    <div style="width: 5%;">{[this.getTotalFor(\'store_products_smart_cart\')]}</div>',
                                                    //                '    <div style="width: 5%;">{[this.getTotalFor(\'store_products_rm_plc\')]}</div>',
                                                    //                '    <div style="width: 9%;">{[this.getTotalFor(\'store_monthly_subscription\')]}</div>',
                                                    //                '</div>',
                                                    //                {
                                                    //                     getTotalFor: function(value){
                                                    //                         var x = [];
                                                    //                         var y;
                                                    //                         var sum = 0;
                                                    //                         store.each(function(record,id){
                                                    //                             if(value=='Users') {
                                                    //                                 y = record.get('manager_firstname')+" "+record.get('manager_lastname');
                                                    //                             }
                                                    //                             else
                                                    //                                 y = record.get(value);
                                                    //                             if(value=='store_products_datalink' || value=='store_products_ecatalog' ||
                                                    //                                value=='store_products_smart_cart' || value=='store_products_rm_plc') {
                                                    //                                 if(y === true)
                                                    //                                     x.push(y);
                                                    //                             }
                                                    //                             else if(value == 'store_monthly_subscription') {
                                                    //                                 y = parseFloat(y.replace("$",'').replace(",",""));
                                                    //                                 sum+=y;
                                                    //                             }
                                                    //                             else
                                                    //                                 Ext.Array.include(x,y);
                                                    //                         });
                                                    //                         if(value == 'store_monthly_subscription')
                                                    //                             return '$'+Math.round(sum);
                                                    //                         else
                                                    //                             return x.length;
                                                    //                     }
                                                    //                }
                                                    //               )
                                                    // );

                                                },
                                                event: 'initialize'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'fieldset',
                                        cls: ' x-rm-no_borderflds',
                                        height: 80,
                                        width: '100%',
                                        items: [
                                            {
                                                xtype: 'textfield',
                                                disabled: true,
                                                itemId: 'billingReportTotalAmtFild',
                                                inputCls: 'boldInputFld inputdisabledClsFldAsLbl',
                                                label: '<b>Total</b>',
                                                labelWidth: '28%'
                                            },
                                            {
                                                xtype: 'textfield',
                                                disabled: true,
                                                itemId: 'billingReportAvgAmtFild',
                                                inputCls: 'inputdisabledClsFldAsLbl',
                                                label: 'Average Account',
                                                labelWidth: '28%'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'fieldset',
                                        height: 80,
                                        width: '100%',
                                        items: [
                                            {
                                                xtype: 'textfield',
                                                itemId: 'billingReportTargetAmtFild',
                                                label: 'Target amount',
                                                labelWidth: '28%'
                                            },
                                            {
                                                xtype: 'textfield',
                                                disabled: true,
                                                itemId: 'billingReportNewAccToBeAddedFild',
                                                label: 'New accounts to be added',
                                                labelWidth: '28%'
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        title: 'Yearly',
                        height: '100%',
                        layout: 'fit',
                        items: [
                            {
                                xtype: 'formpanel',
                                cls: ' x-rm-rdformpanel',
                                height: '100%',
                                itemId: 'billingYearlyReportForm',
                                width: '100%',
                                layout: 'vbox',
                                scrollable: false,
                                items: [
                                    {
                                        xtype: 'fieldset',
                                        height: '80px',
                                        margin: '10 0 0 0',
                                        padding: '5 5 5 5',
                                        width: '40%',
                                        items: [
                                            {
                                                xtype: 'selectfield',
                                                itemId: 'billingReportSelectProductFld',
                                                label: 'Select Product',
                                                options: [
                                                    {
                                                        text: 'Datalink',
                                                        value: 'product_datalink'
                                                    },
                                                    {
                                                        text: 'RM PRO',
                                                        value: 'product_rmpro'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'fieldset',
                                                hidden: true,
                                                padding: '2 2 2 2',
                                                layout: 'hbox',
                                                title: '  <div style="font-size:12px;">Duration</div>',
                                                items: [
                                                    {
                                                        xtype: 'textfield',
                                                        action: 'inputByDatePicker',
                                                        flex: 1,
                                                        itemId: 'billingReportFromDateFld',
                                                        label: 'From'
                                                    },
                                                    {
                                                        xtype: 'textfield',
                                                        action: 'inputByDatePicker',
                                                        flex: 1,
                                                        itemId: 'billingReportToDateFld',
                                                        label: 'To'
                                                    }
                                                ]
                                            },
                                            {
                                                xtype: 'button',
                                                cls: 'x-rm-blueBtn',
                                                itemId: 'billingGenerateYearlyReportBtn',
                                                margin: '0 0 0 70%',
                                                width: '160px',
                                                text: 'Generate Report'
                                            }
                                        ]
                                    },
                                    {
                                        xtype: 'fieldset',
                                        flex: 1,
                                        itemId: 'billingReportListFldSet',
                                        width: '100%',
                                        layout: 'vbox',
                                        items: [
                                            {
                                                xtype: 'listwithheader',
                                                flex: 1
                                            },
                                            {
                                                xtype: 'list',
                                                scrollable: 'false',
                                                cls: [
                                                    'x-rm-list',
                                                    'x-rm-rdvendorslist'
                                                ],
                                                height: '110px',
                                                itemId: 'totalList',
                                                disableSelection: true,
                                                itemTpl: [
                                                    '<div>List Item {string}</div>'
                                                ],
                                                itemHeight: 22
                                            }
                                        ],
                                        listeners: [
                                            {
                                                fn: function(component, eOpts) {

                                                    var headers = component.down("#headerList");
                                                    headers.setData([{}]);
                                                    headers.setItemTpl(
                                                    Ext.create('Ext.XTemplate',
                                                    '<div class="x-rm-listtpl-main">',
                                                    '    <div style="width: 8%;" data-name="store_account">',
                                                    '        Account #&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 12%;" data-name="store_name">',
                                                    '        Store&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month0">',
                                                    '        Jan&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month1">',
                                                    '        Feb&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month2">',
                                                    '        Mar&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month3">',
                                                    '        Apr&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month4">',
                                                    '        May&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month5">',
                                                    '        Jun&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month9">',
                                                    '        Jul&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month7">',
                                                    '        Aug&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month8">',
                                                    '       Sep&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month9">',
                                                    '       Oct&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month10">',
                                                    '       Nov&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" data-name="month11">',
                                                    '       Dec&nbsp;<img src="resources/images/button_icons/downArrow.png"/>',
                                                    '    </div>',
                                                    '    <div style="width: 6%;" >',
                                                    '       <b>Total</b>&nbsp;',
                                                    '    </div>',
                                                    '</div>'
                                                    )
                                                    );
                                                    headers.refresh();
                                                    var list = component.down('#mainList');
                                                    list.setStore(Ext.getStore('billing.YearlyReportStore'));
                                                    list.setItemTpl(
                                                    Ext.create('Ext.XTemplate',
                                                    '<div class="x-rm-listtpl-main">',
                                                    '    <div style="width: 8%;"> {store_account}</div>',
                                                    '    <div style="width: 12%;">{store_name}</div>',
                                                    '    <div style="width: 6%;">{month0}</div>',
                                                    '    <div style="width: 6%;">{month1}</div>',
                                                    '    <div style="width: 6%;">{month2}</div>',
                                                    '    <div style="width: 6%;">{month3}</div>',
                                                    '    <div style="width: 6%;">{month4}</div>',
                                                    '    <div style="width: 6%;">{month5}</div>',
                                                    '    <div style="width: 6%;">{month6}</div>',
                                                    '    <div style="width: 6%;">{month7}</div>',
                                                    '    <div style="width: 6%;">{month8}</div>',
                                                    '    <div style="width: 6%;">{month9}</div>',
                                                    '    <div style="width: 6%;">{month10}</div>',
                                                    '    <div style="width: 6%;">{month11}</div>',
                                                    '    <div style="width: 6%;"><b>{[this.getTotal(values)]}</b></div>',
                                                    '</div>',
                                                    {
                                                        getTotal: function(values){

                                                            var total = 0 ;

                                                            for(var i=0; i < 12 ; i++){

                                                                total += parseInt(values["month"+i],0);

                                                            }

                                                            return total ;

                                                        }
                                                    }
                                                    )
                                                    );

                                                    // list.setMode("SINGLE");
                                                    //     list.on("select",function(rmProlist, record, eOpts){
                                                    //         RMdatalink.app.getController('RMProController').onProductRMProListSelect(rmProlist, record, eOpts);
                                                    // });

                                                    list.setItemHeight(22);

                                                    list.addCls('x-rm-rdvendorslist');

                                                    //list.onStoreClear();
                                                    //list.refresh();



                                                    var totalsList = component.down('#totalList');
                                                    // var store = list.getStore();
                                                    // totalsList.setData([{}]);
                                                    totalsList.setItemTpl(
                                                    Ext.create('Ext.XTemplate',
                                                    '<div style= "font-weight: bold;" class="x-rm-listtpl-main">',
                                                    '    <div style="width: 20%;">{title}</div>',
                                                    '    <div style="width: 6%;">{month0}</div>',
                                                    '    <div style="width: 6%;">{month1}</div>',
                                                    '    <div style="width: 6%;">{month2}</div>',
                                                    '    <div style="width: 6%;">{month3}</div>',
                                                    '    <div style="width: 6%;">{month4}</div>',
                                                    '    <div style="width: 6%;">{month5}</div>',
                                                    '    <div style="width: 6%;">{month6}</div>',
                                                    '    <div style="width: 6%;">{month7}</div>',
                                                    '    <div style="width: 6%;">{month8}</div>',
                                                    '    <div style="width: 6%;">{month9}</div>',
                                                    '    <div style="width: 6%;">{month10}</div>',
                                                    '    <div style="width: 6%;">{month11}</div>',
                                                    '    <div style="width: 6%;"><b>{[this.getTotal(values)]}</b></div>',
                                                    '</div>',
                                                    {
                                                        getTotal: function(values){

                                                            var total = 0 ;

                                                            for(var i=0; i < 12 ; i++){

                                                                total += parseInt(values["month"+i],0);

                                                            }

                                                            return total ;

                                                        }
                                                    }
                                                    )
                                                    );

                                                },
                                                event: 'initialize'
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        xtype: 'container',
                        title: 'Projection'
                    },
                    {
                        xtype: 'container',
                        title: 'Tab 3'
                    }
                ]
            }
        ],
        listeners: [
            {
                fn: 'onBillingReportScreenPainted',
                event: 'painted'
            }
        ]
    },

    onBillingReportScreenPainted: function(element, eOpts) {
        RMdatalink.app.getController('BillingReportController').initBillingReport() ;
    }

});